setwd("~/Desktop/Plotly/NottinghamForest/NottinghamForest")
source("all_functions.R")
source("01_Scores_data_processing.R")
source("02_Standings_data_processing.R")
source("03_Goal_Distribution_data_processing.R")
source("04_Performance_data_processing.R")
source("05_vstheworld_data_processing.R")
scatter_scoredata<-readRDS(file = "scatter_scoredata.rds")
scatter_base<-scatter_scoredata%>%
#highlight_key(~Team_Against)%>%
plot_ly(x=~jitter(GoalAgainst), y=~jitter(GoalScored), size=~1, text=~Team_Against_Date,
hoverinfo="text", colors=c("#fed976", "#ef3b2c"))%>%
layout(xaxis=list(title="Goals Against", dtick = 1, tick0 = 0, tickmode = "linear"),
yaxis=list(title="Goals Scored", dtick = 1, tick0 = 0, tickmode = "linear"))
scatter_base_plot<-scatter_base%>%
add_markers(color=~GameType, frame= ~ Season)
#########################################################################3
bar_scoredata<-readRDS(file = "bar_scoredata.rds")
bar_scoredata_base<-bar_scoredata%>%
plot_ly(x=~GameType,size=~1)
bar_scoredata_base_gamenumber_plot<-bar_scoredata_base%>%
add_trace(y = ~W, type = 'bar',
text = ~W, hoverinfo="text",
marker = list(color = '#67a9cf'),
# marker = list(color = '#cb181d',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Win',frame=~Season)%>%
add_trace(y = ~D, type = 'bar',
text = ~D, hoverinfo="text",
marker = list(color = '#fe9929'),
# marker = list(color = '#6a51a3',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Draw',frame=~Season)%>%
add_trace(y = ~L, type = 'bar',
text = ~L, hoverinfo="text",
marker = list(color = '#969696'),
# marker = list(color = '#525252',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Loss',frame=~Season)%>%
add_trace(y = ~P, type = 'bar',
text = ~P, hoverinfo="text",
marker = list(color = '#8c6bb1'),
# marker = list(color = '#fd8d3c',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Total',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Games", dtick = 5, tick0 = 0, tickmode = "linear"))
bar_scoredata_base_gamescore_plot<-bar_scoredata_base%>%
add_trace(y = ~GF, type = 'bar',
text = ~GF, hoverinfo="text",
marker = list(color = '#41ab5d'),
# marker = list(color = '#238b45',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Scored',frame=~Season)%>%
add_trace(y = ~GA, type = 'bar',
text = ~GA, hoverinfo="text",
marker = list(color = '#8c510a'),
# marker = list(color = '#000000',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Against',frame=~Season)%>%
add_trace(y = ~GD, type = 'bar',
text = ~GD, hoverinfo="text",
marker = list(color = '#e7298a'),
# marker = list(color = '#fed976',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Difference',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Goals", dtick = 10, tick0 = -50, tickmode = "linear"))
bar_base_home_plot<-
subplot( bar_scoredata_base_gamenumber_plot, bar_scoredata_base_gamescore_plot, nrows=2,
heights = c(0.4, 0.6),
titleX=TRUE, titleY = TRUE,margin=0.05,  shareX = TRUE, shareY = FALSE)
s<-subplot(bar_base_home_plot, scatter_base_plot, titleX=TRUE, titleY = TRUE, widths = c(0.3, 0.7),
margin=0.05)
layout(s)
scatter_scoredata<-readRDS(file = "scatter_scoredata.rds")
scatter_base<-scatter_scoredata%>%
#highlight_key(~Team_Against)%>%
plot_ly(x=~jitter(GoalAgainst), y=~jitter(GoalScored), size=~1, text=~Team_Against_Date,
hoverinfo="text", colors=c("#fed976", "#ef3b2c"))%>%
layout(xaxis=list(title="Goals Against", dtick = 1, tick0 = 0, tickmode = "linear"),
yaxis=list(title="Goals Scored", dtick = 1, tick0 = 0, tickmode = "linear"))
scatter_base_plot<-scatter_base%>%
add_markers(color=~GameType, frame= ~ Season)
htmltools::img(src = knitr::image_uri("logo3.jpg"),
alt = 'logo',
style = 'position:relative; top:-900; right:0; padding:10px;')
source("all_functions.R")
source("01_Scores_data_processing.R")
source("02_Standings_data_processing.R")
source("03_Goal_Distribution_data_processing.R")
source("04_Performance_data_processing.R")
source("05_vstheworld_data_processing.R")
scatter_scoredata<-readRDS(file = "scatter_scoredata.rds")
scatter_base<-scatter_scoredata%>%
#highlight_key(~Team_Against)%>%
plot_ly(x=~jitter(GoalAgainst), y=~jitter(GoalScored), size=~1, text=~Team_Against_Date,
hoverinfo="text", colors=c("#fed976", "#ef3b2c"))%>%
layout(xaxis=list(title="Goals Against", dtick = 1, tick0 = 0, tickmode = "linear"),
yaxis=list(title="Goals Scored", dtick = 1, tick0 = 0, tickmode = "linear"))
scatter_base_plot<-scatter_base%>%
add_markers(color=~GameType, frame= ~ Season)
#########################################################################3
bar_scoredata<-readRDS(file = "bar_scoredata.rds")
bar_scoredata_base<-bar_scoredata%>%
plot_ly(x=~GameType,size=~1)
bar_scoredata_base_gamenumber_plot<-bar_scoredata_base%>%
add_trace(y = ~W, type = 'bar',
text = ~W, hoverinfo="text",
marker = list(color = '#67a9cf'),
# marker = list(color = '#cb181d',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Win',frame=~Season)%>%
add_trace(y = ~D, type = 'bar',
text = ~D, hoverinfo="text",
marker = list(color = '#fe9929'),
# marker = list(color = '#6a51a3',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Draw',frame=~Season)%>%
add_trace(y = ~L, type = 'bar',
text = ~L, hoverinfo="text",
marker = list(color = '#969696'),
# marker = list(color = '#525252',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Loss',frame=~Season)%>%
add_trace(y = ~P, type = 'bar',
text = ~P, hoverinfo="text",
marker = list(color = '#8c6bb1'),
# marker = list(color = '#fd8d3c',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Total',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Games", dtick = 5, tick0 = 0, tickmode = "linear"))
bar_scoredata_base_gamescore_plot<-bar_scoredata_base%>%
add_trace(y = ~GF, type = 'bar',
text = ~GF, hoverinfo="text",
marker = list(color = '#41ab5d'),
# marker = list(color = '#238b45',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Scored',frame=~Season)%>%
add_trace(y = ~GA, type = 'bar',
text = ~GA, hoverinfo="text",
marker = list(color = '#8c510a'),
# marker = list(color = '#000000',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Against',frame=~Season)%>%
add_trace(y = ~GD, type = 'bar',
text = ~GD, hoverinfo="text",
marker = list(color = '#e7298a'),
# marker = list(color = '#fed976',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Difference',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Goals", dtick = 10, tick0 = -50, tickmode = "linear"))
bar_base_home_plot<-
subplot( bar_scoredata_base_gamenumber_plot, bar_scoredata_base_gamescore_plot, nrows=2,
heights = c(0.4, 0.6),
titleX=TRUE, titleY = TRUE,margin=0.05,  shareX = TRUE, shareY = FALSE)
s<-subplot(bar_base_home_plot, scatter_base_plot, titleX=TRUE, titleY = TRUE, widths = c(0.3, 0.7),
margin=0.05)
layout(s)
---
output:
html_document:
theme:
bg: "#202123"
fg: "#B8BCC2"
primary: "#EA80FC"
base_font: !expr bslib::font_google("Grandstander")
---
<center> <h1> 1892-2020 Nottingham Forest </h1> </center>
```{r, echo=FALSE}
htmltools::img(src = knitr::image_uri("logo3.jpg"),
alt = 'logo',
style = 'position:relative; top:-900; right:0; padding:10px;')
```
## {.tabset .tabset-pills}
```{r library, echo=FALSE, include=TRUE, eval=TRUE, message=FALSE, warning=FALSE, cache = TRUE}
source("all_functions.R")
source("01_Scores_data_processing.R")
source("02_Standings_data_processing.R")
source("03_Goal_Distribution_data_processing.R")
source("04_Performance_data_processing.R")
source("05_vstheworld_data_processing.R")
```
### Scores
```{r echo=FALSE, include=TRUE, eval=TRUE, message=FALSE, warning=FALSE,out.width = '100%', fig.height=5}
scatter_scoredata<-readRDS(file = "scatter_scoredata.rds")
scatter_base<-scatter_scoredata%>%
#highlight_key(~Team_Against)%>%
plot_ly(x=~jitter(GoalAgainst), y=~jitter(GoalScored), size=~1, text=~Team_Against_Date,
hoverinfo="text", colors=c("#fed976", "#ef3b2c"))%>%
layout(xaxis=list(title="Goals Against", dtick = 1, tick0 = 0, tickmode = "linear"),
yaxis=list(title="Goals Scored", dtick = 1, tick0 = 0, tickmode = "linear"))
scatter_base_plot<-scatter_base%>%
add_markers(color=~GameType, frame= ~ Season)
#########################################################################3
bar_scoredata<-readRDS(file = "bar_scoredata.rds")
bar_scoredata_base<-bar_scoredata%>%
plot_ly(x=~GameType,size=~1)
bar_scoredata_base_gamenumber_plot<-bar_scoredata_base%>%
add_trace(y = ~W, type = 'bar',
text = ~W, hoverinfo="text",
marker = list(color = '#67a9cf'),
# marker = list(color = '#cb181d',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Win',frame=~Season)%>%
add_trace(y = ~D, type = 'bar',
text = ~D, hoverinfo="text",
marker = list(color = '#fe9929'),
# marker = list(color = '#6a51a3',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Draw',frame=~Season)%>%
add_trace(y = ~L, type = 'bar',
text = ~L, hoverinfo="text",
marker = list(color = '#969696'),
# marker = list(color = '#525252',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Loss',frame=~Season)%>%
add_trace(y = ~P, type = 'bar',
text = ~P, hoverinfo="text",
marker = list(color = '#8c6bb1'),
# marker = list(color = '#fd8d3c',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Total',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Games", dtick = 5, tick0 = 0, tickmode = "linear"))
bar_scoredata_base_gamescore_plot<-bar_scoredata_base%>%
add_trace(y = ~GF, type = 'bar',
text = ~GF, hoverinfo="text",
marker = list(color = '#41ab5d'),
# marker = list(color = '#238b45',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Scored',frame=~Season)%>%
add_trace(y = ~GA, type = 'bar',
text = ~GA, hoverinfo="text",
marker = list(color = '#8c510a'),
# marker = list(color = '#000000',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Against',frame=~Season)%>%
add_trace(y = ~GD, type = 'bar',
text = ~GD, hoverinfo="text",
marker = list(color = '#e7298a'),
# marker = list(color = '#fed976',
#               line = list(color = 'rgb(8,48,107)', width = 1.5)),
name='Goals Difference',frame=~Season)%>%
layout(xaxis=list(title="Game Type"),
yaxis=list(title="Number of Goals", dtick = 10, tick0 = -50, tickmode = "linear"))
bar_base_home_plot<-
subplot( bar_scoredata_base_gamenumber_plot, bar_scoredata_base_gamescore_plot, nrows=2,
heights = c(0.4, 0.6),
titleX=TRUE, titleY = TRUE,margin=0.05,  shareX = TRUE, shareY = FALSE)
s<-subplot(bar_base_home_plot, scatter_base_plot, titleX=TRUE, titleY = TRUE, widths = c(0.3, 0.7),
margin=0.05)
layout(s)
```
The raw data were abstracted from engsoccerdata package (James P. Curley (2020). engsoccerdata: English Soccer Data 1871-2019. R package version 0.1.7 DOI).
<center>**This analysis is crunched and posed by ![Tabs1](Tabs1.jpeg). Ryan, I hope you will enjoy the site!**</center>
all_positions_data<-readRDS(file = "all_positions_data.rds")
y_label_order<-c((all_positions_data%>%select(ord_number_Position, Position)%>%
group_by(ord_number_Position, Position)%>%
filter(row_number()==1)%>%
ungroup()%>%arrange(ord_number_Position))$Position)
all_positions_data$Position <- factor(all_positions_data$Position, levels = y_label_order)
all_positions_data_base<-all_positions_data%>%
filter(team==team_care)%>%
plot_ly(x=~Season, y=~Position, text=~ Position_label, hoverinfo="text",
colors=c("#e7298a", "#41ab5d", "#ec7014", "#6a51a3"))%>%
layout(xaxis=list(title="Season", dtick = 10, tick0 = 1892, tickmode = "linear"),
yaxis=list(title="Standing"))
all_positions_data_base_plot<-all_positions_data_base%>%
add_lines(line = list(color = '#525252', width = 2), showlegend=FALSE)%>%
add_markers(color = ~factor(Tier_label))
# add_lines(mode = 'lines+markers')
all_positions_data_base_plot
detailed_goals_final<-readRDS(file = "detailed_goals_final.rds")
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_plot
mydf.final2<-readRDS(file = "mydf.final2.rds")
#text=sprintf("Preceding Season: %s<br>Succeeding Season: %s", pts.pglag, pts.pg)
ggg1 <- ggplot(mydf.final2, aes(pts.pglag, pts.pg)) +
geom_point(size=2, color="#737373",
aes(text=sprintf("Preceding Season(%s): %s<br> Succeeding Season (%s): %s",
Season-1, round(pts.pglag,5), Season, round(pts.pg, 5)))) +
stat_smooth(method="lm",se=F, lwd=1, color="#525252") +
theme_bw() +
xlab("Preceding Season") + ylab("Succeeding Season")
#+ ggtitle("Points per game")
ggg2 <- ggplot(mydf.final2, aes(GF.pglag, GF.pg)) +
geom_point(size=2, color="#41ab5d",
aes(text=sprintf("Preceding Season(%s): %s<br> Succeeding Season (%s): %s",
Season-1, round(GF.pglag,5), Season, round(GF.pg, 5)))) +
stat_smooth(method="lm",se=F, lwd=1, color="#238b45") +
theme_bw() +
xlab("Preceding Season") + ylab("Succeeding Season")
#+ ggtitle("Goals Scored per game")
ggg3 <- ggplot(mydf.final2, aes(GA.pglag, GA.pg)) +
geom_point(size=2, color="#fd8d3c",
aes(text=sprintf("Preceding Season(%s): %s<br> Succeeding Season (%s): %s",
Season-1, round(GA.pglag,5), Season, round(GA.pg, 5)))) +
stat_smooth(method="lm",se=F, lwd=1, color="#f16913") +
theme_bw() +
xlab("Preceding Season") + ylab("Succeeding Season")
#+ ggtitle("Goals Against per game")
ggg4 <- ggplot(mydf.final2, aes(GD.pglag, GD.pg)) +
geom_point(size=2, color="#807dba",
aes(text=sprintf("Preceding Season(%s): %s<br> Succeeding Season (%s): %s",
Season-1, round(GD.pglag,5), Season, round(GD.pg, 5)))) +
stat_smooth(method="lm",se=F, lwd=1, color="#6a51a3") +
theme_bw() +
xlab("Preceding Season") + ylab("Succeeding Season")
#+ ggtitle("Goals Difference per game")
subplot(toWebGL(ggplotly(ggg1,tooltip="text")),
toWebGL(ggplotly(ggg2,tooltip="text")),
toWebGL(ggplotly(ggg3,tooltip="text")), toWebGL(ggplotly(ggg4,tooltip="text")),
nrows=2,
margin=0.1)%>%
layout(annotations = list(
list(x = 0.1 , y = 1.05, text = "Points per game", showarrow = F, xref='paper', yref='paper'),
list(x = 0.92 , y = 1.05, text = "Goals Scored per game", showarrow = F, xref='paper', yref='paper'),
list(x = 0.06 , y = 0.45, text = "Goals Against per game", showarrow = F, xref='paper', yref='paper'),
list(x = 0.92 , y = 0.45, text = "Goals Difference per game", showarrow = F, xref='paper', yref='paper'))
)
mevstheworld_result_spread<-readRDS(file = "mevstheworld_result_spread.rds")
mevstheworld_result_spread<-highlight_key(mevstheworld_result_spread)
vs_team_result<-datatable(mevstheworld_result_spread,
colnames=c('vs. Team'='team_compare', 'Win'='Win', 'Draw'='Draw', 'Loss'='Loss',
'Goals Scored'='goal_me_sum', 'Goals Against'='goal_theworld_sum'),
extensions="Scroller", style="bootstrap", class="compact", width="100%",
options=list(deferRender=TRUE, scrollY=300, scroller=TRUE))
widgets<-bscols(filter_select("team_compare", "vs. Team", mevstheworld_result_spread,~team_compare))
bscols(widths=c(4,7), widgets, vs_team_result)
View(scatter_scoredata)
etailed_goals_final<-readRDS(file = "detailed_goals_final.rds")
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
