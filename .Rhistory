visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_plot
detailed_goals_plot<-highlight_key(detailed_goals_final)%>%
plot_ly(type = 'violin')
detailed_goals_final<-highlight_key(detailed_goals_final)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_final<-highlight_key(detailed_goals_final)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
widgets<-bscols(filter_select("Season", "Season", detailed_goals_final, ~Season))
detailed_goals_plot
detailed_goals_final<-highlight_key(detailed_goals_final)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_plot
widgets<-bscols(filter_select("Season", "Season", detailed_goals_final, ~Season))
View(detailed_goals_final)
detailed_goals<-
rbind(england%>%mutate(team = home, opp = visitor,GF=as.numeric(as.character(hgoal)),
GA=as.numeric(as.character(vgoal)),venue="Home")%>%
select(Date, Season, team, opp, GF, GA, venue),
england%>%mutate(team = visitor, opp = home, GF=as.numeric(as.character(vgoal)),
GA=as.numeric(as.character(hgoal)),venue="Away")%>%
select(Date, Season, team, opp, GF, GA, venue))
detailed_goals_scored<-detailed_goals%>%
mutate(goals=GF)%>%
mutate(goaltype="Goals Scored")%>%
select(Date, Season, team, opp, venue, goals, goaltype)
detailed_goals_against<-detailed_goals%>%
mutate(goals=GA)%>%
mutate(goaltype="Goals Against")%>%
select(Date, Season, team, opp, venue, goals, goaltype)
detailed_goals_final<-rbind(detailed_goals_scored, detailed_goals_against)
detailed_goals_final<-rbind(detailed_goals_final%>%mutate(venue="All"),
detailed_goals_final)%>%
filter(team==team_care)
detailed_goals_final<-highlight_key(detailed_goals_final)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
widgets<-bscols(filter_select("Season", "Season", detailed_goals_final, ~Season))
bscols(widgets, detailed_goals_plot)
widgets
detailed_goals_plot
hey<-detailed_goals_final
hey<-detailed_goals_final
detailed_goals_final<-highlight_key(detailed_goals_final)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[hey$goaltype == 'Goals Scored'],
y = ~goals[hey$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[hey$goaltype == 'Goals Against'],
y = ~goals[hey$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
widgets<-bscols(filter_select("Season", "Season", detailed_goals_final, ~Season))
detailed_goals_plot
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
widgets<-bscols(filter_select("Season", "Season", detailed_goals_final, ~Season))
detailed_goals_plot
detailed_goals<-
rbind(england%>%mutate(team = home, opp = visitor,GF=as.numeric(as.character(hgoal)),
GA=as.numeric(as.character(vgoal)),venue="Home")%>%
select(Date, Season, team, opp, GF, GA, venue),
england%>%mutate(team = visitor, opp = home, GF=as.numeric(as.character(vgoal)),
GA=as.numeric(as.character(hgoal)),venue="Away")%>%
select(Date, Season, team, opp, GF, GA, venue))
detailed_goals_scored<-detailed_goals%>%
mutate(goals=GF)%>%
mutate(goaltype="Goals Scored")%>%
select(Date, Season, team, opp, venue, goals, goaltype)
detailed_goals_against<-detailed_goals%>%
mutate(goals=GA)%>%
mutate(goaltype="Goals Against")%>%
select(Date, Season, team, opp, venue, goals, goaltype)
detailed_goals_final<-rbind(detailed_goals_scored, detailed_goals_against)
detailed_goals_final<-rbind(detailed_goals_final%>%mutate(venue="All"),
detailed_goals_final)%>%
filter(team==team_care)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_plot<-detailed_goals_final%>%
plot_ly(type = 'violin')
detailed_goals_plot <- detailed_goals_plot %>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Scored'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Scored'],
legendgroup = 'Goals Scored',
scalegroup = 'Goals Scored',
name = 'Goals Scored',
side = 'negative',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#238b45")
)%>%
add_trace(
x = ~venue[detailed_goals_final$goaltype == 'Goals Against'],
y = ~goals[detailed_goals_final$goaltype == 'Goals Against'],
legendgroup = 'Goals Against',
scalegroup = 'Goals Against',
name = 'Goals Against',
side = 'positive',
box = list(
visible = T
),
meanline = list(
visible = T
),
color = I("#e7298a")
)%>%
layout(
xaxis = list(
title = ""
),
yaxis = list(
title = "Goals",
zeroline = F,
dtick = 1, tick0 = 0, tickmode = "linear"
),
violingap = 0,
violingroupgap = 0,
violinmode = 'overlay'
)
detailed_goals_plot
htmltools::img(src = knitr::image_uri("logo3.jpg"),
alt = 'logo',
style = 'position:relative; top:-900; right:0; padding:10px;')
source("all_functions.R")
source("01_Scores_data_processing.R")
setwd("~/Desktop/Plotly/NottinghamForest/NottinghamForest")
htmltools::img(src = knitr::image_uri("logo3.jpg"),
alt = 'logo',
style = 'position:relative; top:-900; right:0; padding:10px;')
source("all_functions.R")
source("01_Scores_data_processing.R")
#############################################################
# Process the data for scores
addtitional_data<-england_current_new()%>%
mutate(division=as.character(division))
england<-bind_rows(england,addtitional_data)%>%
group_by(Season, Date, home, visitor, hgoal, vgoal, result)%>%
filter(row_number()==1)%>%
ungroup()
# Let's try to make scatter plot in which x-axis is the goal the being lost and yaxis is the goal the wins
team_care<-c("Nottingham Forest")
scatter_scoredata<-all_score_team_new(england, teamname=team_care)%>%
# mutate(GameType=case_when(home==team_care & result=="D" ~ "Home - Draw",
#                           home==team_care & result=="A" ~ "Home - Loss",
#                           home==team_care & result=="H" ~ "Home - Win",
#                           !(home==team_care) & result=="D" ~ "Away - Draw",
#                           !(home==team_care) & result=="A" ~ "Away - Win",
#                           !(home==team_care) & result=="H" ~ "Away - Loss",
#                           TRUE ~ "N/A"
#                           ))%>%
mutate(GameType=ifelse(home==team_care, "Home", "Away"))%>%
mutate(ResultType=case_when(home==team_care & result=="D" ~ "Draw",
home==team_care & result=="A" ~ "Loss",
home==team_care & result=="H" ~ "Win",
!(home==team_care) & result=="D" ~ "Draw",
!(home==team_care) & result=="A" ~ "Away - Win",
!(home==team_care) & result=="H" ~ "Away - Loss",
TRUE ~ "N/A"
))%>%
mutate(Team_Against_Date=ifelse(home==team_care,
paste0("Against ", visitor, " (Division ",division, " - ", Date, "): ", hgoal, " - ", vgoal),
paste0("Against ", home, " (Division ", division, " - ", Date, "): ", vgoal, " - ", hgoal)))%>%
mutate(Team_Against=ifelse(home==team_care, visitor, home))%>%
mutate(GoalScored=ifelse(home==team_care, hgoal, vgoal))%>%
mutate(GoalAgainst=ifelse(home==team_care, vgoal, hgoal))
saveRDS(scatter_scoredata, file = "scatter_scoredata.rds")
bar_scoredata<-alltimerecord_new(england, team_care)
saveRDS(bar_scoredata, file = "bar_scoredata.rds")
#############################################################
rmarkdown::render("index.Rmd")
